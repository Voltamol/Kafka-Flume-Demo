# Flume Demo Configuration
# Collects web server logs and sends to HDFS
# Save as: flume-demo.conf

# Agent name
agent.sources = weblog-source
agent.channels = memory-channel
agent.sinks = hdfs-sink logger-sink

# ============================================================================
# SOURCE: Tail the web server log file
# ============================================================================
agent.sources.weblog-source.type = exec
agent.sources.weblog-source.command = tail -F /tmp/demo-webserver.log
agent.sources.weblog-source.channels = memory-channel

# Add timestamp interceptor
agent.sources.weblog-source.interceptors = timestamp
agent.sources.weblog-source.interceptors.timestamp.type = timestamp

# ============================================================================
# CHANNEL: Memory channel for fast processing
# ============================================================================
agent.channels.memory-channel.type = memory
agent.channels.memory-channel.capacity = 10000
agent.channels.memory-channel.transactionCapacity = 1000

# ============================================================================
# SINK 1: Write to HDFS (organized by date)
# ============================================================================
agent.sinks.hdfs-sink.type = hdfs
agent.sinks.hdfs-sink.channel = memory-channel
agent.sinks.hdfs-sink.hdfs.path = hdfs://localhost:9000/demo/weblogs/%Y-%m-%d
agent.sinks.hdfs-sink.hdfs.filePrefix = access
agent.sinks.hdfs-sink.hdfs.fileSuffix = .log
agent.sinks.hdfs-sink.hdfs.rollInterval = 30
agent.sinks.hdfs-sink.hdfs.rollSize = 0
agent.sinks.hdfs-sink.hdfs.rollCount = 50
agent.sinks.hdfs-sink.hdfs.fileType = DataStream
agent.sinks.hdfs-sink.hdfs.writeFormat = Text
agent.sinks.hdfs-sink.hdfs.useLocalTimeStamp = true

# ============================================================================
# SINK 2: Logger sink (for demo visibility)
# ============================================================================
agent.sinks.logger-sink.type = logger
agent.sinks.logger-sink.channel = memory-channel

# ============================================================================
# Sink Groups (optional - for better demo)
# ============================================================================
# Uncomment to see both HDFS and console output
# agent.sinkgroups = demo-group
# agent.sinkgroups.demo-group.sinks = hdfs-sink logger-sink
# agent.sinkgroups.demo-group.processor.type = load_balance