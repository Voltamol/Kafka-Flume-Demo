# Flume Agent Configuration for Kafka-to-HDFS (Notifications)
agent.sources = kafka-source
agent.channels = file-channel
agent.sinks = hdfs-sink

# ============================================================================
# SOURCE: Reads from the Kafka 'notifications' Topic
# ============================================================================
agent.sources.kafka-source.type = org.apache.flume.source.kafka.KafkaSource
agent.sources.kafka-source.kafka.bootstrap.servers = localhost:9092
agent.sources.kafka-source.kafka.topics = notifications
agent.sources.kafka-source.kafka.auto.offset.reset = earliest
agent.sources.kafka-source.kafka.consumer.group.id = flume-notifications-archiver

# ============================================================================
# CHANNEL: File Channel (More robust than memory for production)
# ============================================================================
agent.channels.file-channel.type = file
agent.channels.file-channel.checkpointDir = /tmp/flume/notifications/checkpoint
agent.channels.file-channel.dataDirs = /tmp/flume/notifications/data

# ============================================================================
# SINK: Write Notification Data to HDFS (for analysis/archival)
# ============================================================================
agent.sinks.hdfs-sink.type = hdfs
agent.sinks.hdfs-sink.channel = file-channel
agent.sinks.hdfs-sink.hdfs.path = hdfs://localhost:9000/archive/notifications/%Y-%m-%d
agent.sinks.hdfs-sink.hdfs.filePrefix = notifications-archive
agent.sinks.hdfs-sink.hdfs.fileSuffix = .json
agent.sinks.hdfs-sink.hdfs.rollInterval = 60
agent.sinks.hdfs-sink.hdfs.rollSize = 10485760
agent.sinks.hdfs-sink.hdfs.fileType = DataStream
agent.sinks.hdfs-sink.hdfs.writeFormat = Text

# Bind source and sink to the channel
agent.sources.kafka-source.channels = file-channel
agent.sinks.hdfs-sink.channel = file-channel